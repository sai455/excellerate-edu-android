"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5121],{5121:(G,u,r)=>{r.d(u,{r:()=>A});var p=r(467),t=r(1626),g=r(1840),e=r(4438),d=r(3465),c=r(2571),h=r(6886),P=r(177);const _=()=>[0,1,2,3,4,5,6,7,8,9,10];function f(s,m){if(1&s&&(e.j41(0,"ion-label")(1,"h4"),e.EFF(2),e.k0s()()),2&s){const i=e.XpG();e.R7$(2),e.Lme("Selected Groups : ",i.groupsSelected(),", Users : ",i.usersSelected(),"")}}function T(s,m){if(1&s){const i=e.RV6();e.j41(0,"ion-searchbar",6),e.bIt("keyup",function(n){e.eBV(i);const o=e.XpG();return e.Njj(o.onSearchKeyUp(n))})("ionClear",function(){e.eBV(i);const n=e.XpG();return e.Njj(n.items=n.itemsMain)}),e.k0s()}}function y(s,m){1&s&&(e.j41(0,"ion-card")(1,"ion-row")(2,"ion-col",8),e.nrm(3,"ion-skeleton-text",9),e.k0s()(),e.j41(4,"ion-row")(5,"ion-col",8),e.nrm(6,"ion-skeleton-text",9),e.k0s()(),e.j41(7,"ion-row")(8,"ion-col",8),e.nrm(9,"ion-skeleton-text",9),e.k0s()(),e.j41(10,"ion-row")(11,"ion-col",8),e.nrm(12,"ion-skeleton-text",9),e.k0s()(),e.j41(13,"ion-row")(14,"ion-col",8),e.nrm(15,"ion-skeleton-text",9),e.k0s()(),e.j41(16,"ion-row",10)(17,"ion-col",11),e.nrm(18,"ion-skeleton-text",9),e.k0s()()())}function I(s,m){1&s&&(e.j41(0,"div")(1,"ion-list"),e.DNE(2,y,19,0,"ion-card",7),e.k0s()()),2&s&&(e.R7$(2),e.Y8G("ngForOf",e.lJ4(1,_)))}function S(s,m){1&s&&(e.j41(0,"ion-item-divider")(1,"ion-label",14)(2,"h2"),e.EFF(3,"Name"),e.k0s()(),e.j41(4,"ion-label",15)(5,"h2"),e.EFF(6,"Read"),e.k0s()(),e.j41(7,"ion-label")(8,"h2"),e.EFF(9,"Modify"),e.k0s()()())}function M(s,m){if(1&s){const i=e.RV6();e.j41(0,"ion-list"),e.DNE(1,S,10,0,"ion-item-divider",4),e.j41(2,"ion-item")(3,"ion-label")(4,"h2"),e.EFF(5),e.k0s()(),e.j41(6,"ion-checkbox",12),e.bIt("ionChange",function(n){const o=e.eBV(i).$implicit,l=e.XpG(2);return e.Njj(l.onToggle(n,o,1))}),e.k0s(),e.j41(7,"ion-checkbox",13),e.bIt("ionChange",function(n){const o=e.eBV(i).$implicit,l=e.XpG(2);return e.Njj(l.onToggle(n,o,2))}),e.k0s()()()}if(2&s){const i=m.$implicit,a=m.index;e.R7$(),e.Y8G("ngIf",0==a),e.R7$(4),e.JRh(i.name),e.R7$(),e.FS9("checked",i.ReadFlag),e.R7$(),e.FS9("checked",i.ModifyFlag)}}function F(s,m){if(1&s&&(e.j41(0,"div"),e.DNE(1,M,8,4,"ion-list",7),e.k0s()),2&s){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.items)}}let A=(()=>{class s{constructor(i,a,n){this.modalController=i,this.commonService=a,this.apiCall=n,this.isAPiCallInProcess=!1,this.items=[],this.itemsMain=[],this.studentsChanged=[]}ngOnInit(){this.getGroupsList()}getGroupsList(){let i=new t.Nl;i=i.append("UserID",this.userId),i=i.append("tenantName",this.tenantShortName),i=i.append("NodeId",this.nodeId),i=i.append("NodeCategoryId",this.nodeCategoryId),this.isAPiCallInProcess=!0,this.apiCall.login(g.h.urls.GetDMSPermissionList,i).subscribe({next:a=>{this.groupList=a.Permissions,this.isAPiCallInProcess=!1,this.fillItemsList()},error:a=>{this.isAPiCallInProcess=!1}})}closeModal(){var i=this;return(0,p.A)(function*(){yield i.modalController.dismiss(null)})()}fillItemsList(){for(let a of this.groupList)if(a.IName.length>0){var i={name:a.IName,Type:"Groups"==a.IType?1:2,Id:"Groups"==a.IType?a.GroupId:a.UserId,UserId:"Groups"==a.IType?"Group":a.UserName,ReadFlag:a.Read,ModifyFlag:a.Modify};this.itemsMain.push(i),(1==i.ReadFlag||1==i.ModifyFlag)&&this.studentsChanged.push(i)}this.items=this.itemsMain}onSearchKeyUp(i){let a=i.target.value;this.items=0==a.length?this.itemsMain:this.itemsMain.filter(n=>n.name.toLocaleLowerCase().includes(a.toLocaleLowerCase()||n.Id.toString().includes(a)||n.UserId.toString().includes(a)))}onToggle(i,a,n){1==n?a.ReadFlag=!a.ReadFlag:a.ModifyFlag=!a.ModifyFlag;var o=this.studentsChanged.filter(l=>l.Id==a.Id&&l.Type==a.Type);o&&o.length>0?this.studentsChanged.forEach(function(l){l.Id==a.Id&&l.Type==a.Type&&(1==n?l.ReadFlag=a.ReadFlag:l.ModifyFlag=a.ModifyFlag)}):this.studentsChanged.push(a)}groupsSelected(){return this.studentsChanged.filter(i=>1==i.Type&&(1==i.ReadFlag||1==i.ModifyFlag)).length}usersSelected(){return this.studentsChanged.filter(i=>2==i.Type&&(1==i.ReadFlag||1==i.ModifyFlag)).length}SavePermissions(){let i=new t.Nl;i=i.append("UserID",this.userId),i=i.append("tenantName",this.tenantShortName),i=i.append("NodeId",this.nodeId);let a=[],n=this.nodeId;for(let o of this.studentsChanged)(1==o.ReadFlag||o.ModifyFlag)&&a.push({NodeId:n,GroupId:1==o.Type?o.Id:0,UserId:2==o.Type?o.Id:0,Read:o.ReadFlag,Modify:o.ModifyFlag,IType:1==o.Type?"Groups":"Users"});i=i.append("permissions",JSON.stringify(a)),this.isAPiCallInProcess=!0,this.apiCall.login(g.h.urls.UpdateDMSPermissions,i).subscribe(o=>{this.isAPiCallInProcess=!1,this.commonService.presentToast("Permissions Updated Successfully",3e3,"success"),this.closeModal()},o=>{this.commonService.presentToast("An Error Occurred, Please contact admin",3e3,"danger"),this.isAPiCallInProcess=!1})}myHeaderFn(i,a,n){return 0===a?"Header "+a:null}static{this.\u0275fac=function(a){return new(a||s)(e.rXU(d.W3),e.rXU(c.h),e.rXU(h.J))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-people-list"]],inputs:{modalTitle:"modalTitle",nodeId:"nodeId",nodeCategoryId:"nodeCategoryId",userId:"userId",tenantShortName:"tenantShortName"},standalone:!1,decls:13,vars:6,consts:[["color","danger"],[1,"ion-padding"],["size","small","type","button","color","success",3,"click","disabled"],["size","small","type","button","color","danger",3,"click"],[4,"ngIf"],["showCancelButton","never","placeholder","Search User / Group",3,"keyup","ionClear",4,"ngIf"],["showCancelButton","never","placeholder","Search User / Group",3,"keyup","ionClear"],[4,"ngFor","ngForOf"],["size","12"],["animated","",2,"width","100%"],[2,"border-top","1px solid #ffffff"],["size","4","offset","4"],["slot","end","color","primary",3,"ionChange","checked"],["slot","end","color","success",3,"ionChange","checked"],[2,"margin-right","55%"],[2,"margin-right","2%"]],template:function(a,n){1&a&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),e.EFF(3),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-button",2),e.bIt("click",function(){return n.SavePermissions()}),e.EFF(6," Save Permissions"),e.k0s(),e.j41(7,"ion-button",3),e.bIt("click",function(){return n.closeModal()}),e.EFF(8," Cancel"),e.k0s(),e.DNE(9,f,3,2,"ion-label",4)(10,T,1,0,"ion-searchbar",5)(11,I,3,2,"div",4)(12,F,2,1,"div",4),e.k0s()),2&a&&(e.R7$(3),e.JRh(n.modalTitle),e.R7$(2),e.Y8G("disabled",n.isAPiCallInProcess),e.R7$(4),e.Y8G("ngIf",n.studentsChanged&&n.studentsChanged.length>0),e.R7$(),e.Y8G("ngIf",!n.isAPiCallInProcess),e.R7$(),e.Y8G("ngIf",n.isAPiCallInProcess),e.R7$(),e.Y8G("ngIf",!n.isAPiCallInProcess))},dependencies:[P.Sq,P.bT,d.Jm,d.b_,d.eY,d.hU,d.W9,d.eU,d.uz,d.Dg,d.he,d.nf,d.ln,d.S1,d.ds,d.BC,d.ai,d.hB,d.Gw],encapsulation:2})}}return s})()},1840:(G,u,r)=>{r.d(u,{h:()=>t});class t{static{this.mainPath="https://excelsis360.com/ExcelsisMobileAPI/"}static{this.urls={login:t.mainPath+"Login",circularList:t.mainPath+"GetCirculars",homeWorkList:t.mainPath+"GetStudentCoursePlanDetails",GetReportCard:t.mainPath+"GetStudentProgressReport",GetTenantNames:t.mainPath+"GetTenantsList",GetUserFeeDetails:t.mainPath+"GetUserFeeDetails",GetNotifications:t.mainPath+"GetNotifications",GetSyllabas:t.mainPath+"GetChapterTopicsByUserId",GetFeedbackList:t.mainPath+"GetFeedbackList",GetMeetingsList:t.mainPath+"GetMeetingsList",MeetingHostJoined:t.mainPath+"MeetingHostJoined",MeetingEnd:t.mainPath+"EndMeeting",getGropusList:t.mainPath+"GetGroupDropDowns",getStudentList:t.mainPath+"",startMeeting:t.mainPath+"JoinMeeting",sendGroupMail:t.mainPath+"SendGroupMail",GetStudentTodayAttendanceDetails:t.mainPath+"GetStudentTodayAttendanceDetails",GetStudentCurrentMonthAttendanceDetails:t.mainPath+"GetStudentCurrentMonthAttendanceDetails",GetStudentLastThreeMonthsAttendanceDetails:t.mainPath+"GetStudentLastThreeMonthsAttendanceDetails",GetCalendarEvents:t.mainPath+"GetCalendarEvents",GetStudentTermAttendanceDetails:t.mainPath+"GetStudentTermAttendanceDetails",SaveFeedback:t.mainPath+"SaveFeedback",AddFeedback:t.mainPath+"AddFeedback",GetFeedbackTypes:t.mainPath+"GetFeedbackTypes",GetFeedbackCategoriesByType:t.mainPath+"GetFeedbackCategoriesByType",GetFeedbackStepsByTypeCategory:t.mainPath+"GetFeedbackStepsByTypeCategory",GetGalleryList:t.mainPath+"GetUserDMS",GetAllNodes:t.mainPath+"getAllNodes",AddUserDMSFolder:t.mainPath+"AddUserDMSFolder",UpdateDMSFileName:t.mainPath+"UpdateDMSFileName",AddUserDMSFile:t.mainPath+"AddUserDMSFile",DeleteNode:t.mainPath+"DeleteNode",GetDMSPermissionList:t.mainPath+"GetDMSPermissionList",UpdateDMSPermissions:t.mainPath+"UpdateDMSPermissions",SiteLinks:t.mainPath+"GetSiteLinks",GetAttendanceSubjects:t.mainPath+"GetAttendanceSubjects",GetAttendanceAcademicYears:t.mainPath+"GetAttendanceAcademicYears",GetAttendanceTerms:t.mainPath+"GetAttendanceTerms",GetAttendanceSection:t.mainPath+"GetAttendanceSection",GetAttendanceStudentsList:t.mainPath+"GetAttendanceStudentsList",SaveStudentsAttendance:t.mainPath+"SaveStudentsAttendance",GetPaymentOrderId:t.mainPath+"GetPaymentOrderId",GetTransactionDues:t.mainPath+"GetTransactionDues",GetTransactionsPaid:t.mainPath+"GetTransactionsPaid",ValidatePaymentCaptured:t.mainPath+"ValidatePaymentCaptured",DeleteCalendarEvent:t.mainPath+"DeleteCalendarEvent",AddCalendarEvents:t.mainPath+"AddCalendarEvents",GetCommunicatorTypes:t.mainPath+"GetCommunicatorTypes",GetFormsByType:t.mainPath+"GetFormsByType",SendCommunicator:t.mainPath+"SendCommunicator",GetStaffAttendanceRoles:t.mainPath+"GetStaffAttendanceRoles",GetStaffAttendance:t.mainPath+"GetStaffAttendance",SaveStaffAttendance:t.mainPath+"SaveStaffAttendance",GetUsersAsync:t.mainPath+"GetUsersAsync",GetDynamicDashboardsList:t.mainPath+"GetDynamicDashboardsList",GetDynamicDashboardAsync:t.mainPath+"GetDynamicDashboardAsync",GetTrips:t.mainPath+"GetTrips",UpdateTripLocation:t.mainPath+"UpdateTripLocation",GetBusLocationByTripId:t.mainPath+"GetBusLocationByTripId",EndTrip:t.mainPath+"EndTrip",GetTripDropDowns:t.mainPath+"GetTripDropDowns",CreateTrip:t.mainPath+"CreateTrip",SaveGpsAttendance:t.mainPath+"SaveGpsAttendance",GetGpsAttendance:t.mainPath+"GetGpsAttendance",LogMobileFirebaseToken:t.mainPath+"LogMobileFirebaseToken"}}}},6886:(G,u,r)=>{r.d(u,{J:()=>g});var p=r(1626),t=r(4438);let g=(()=>{class e{constructor(c){this.http=c}getHeadres(){let c=new p.Lr;return c.append("Content-Type","application/json"),c}addItemToList(c,h){let P=new p.Lr;return P.append("Content-Type","application/json"),this.http.post(c,h,{headers:P})}login(c,h){return this.http.get(c,{params:h})}registerUser(c,h){return(new p.Lr).append("Content-Type","application/x-www-form-urlencoded"),this.http.post(c,h,{headers:this.getHeadres()})}getCirculerList(c){return this.http.get(c)}static{this.\u0275fac=function(h){return new(h||e)(t.KVO(p.Qq))}}static{this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})()}}]);