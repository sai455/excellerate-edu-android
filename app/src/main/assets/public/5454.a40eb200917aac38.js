"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5454],{1840:(A,f,r)=>{r.d(f,{h:()=>a});class a{static{this.mainPath="https://excelsis360.com/ExcelsisMobileAPI/"}static{this.urls={login:a.mainPath+"Login",circularList:a.mainPath+"GetCirculars",homeWorkList:a.mainPath+"GetStudentCoursePlanDetails",GetReportCard:a.mainPath+"GetStudentProgressReport",GetTenantNames:a.mainPath+"GetTenantsList",GetUserFeeDetails:a.mainPath+"GetUserFeeDetails",GetNotifications:a.mainPath+"GetNotifications",GetSyllabas:a.mainPath+"GetChapterTopicsByUserId",GetFeedbackList:a.mainPath+"GetFeedbackList",GetMeetingsList:a.mainPath+"GetMeetingsList",MeetingHostJoined:a.mainPath+"MeetingHostJoined",MeetingEnd:a.mainPath+"EndMeeting",getGropusList:a.mainPath+"GetGroupDropDowns",getStudentList:a.mainPath+"",startMeeting:a.mainPath+"JoinMeeting",sendGroupMail:a.mainPath+"SendGroupMail",GetStudentTodayAttendanceDetails:a.mainPath+"GetStudentTodayAttendanceDetails",GetStudentCurrentMonthAttendanceDetails:a.mainPath+"GetStudentCurrentMonthAttendanceDetails",GetStudentLastThreeMonthsAttendanceDetails:a.mainPath+"GetStudentLastThreeMonthsAttendanceDetails",GetCalendarEvents:a.mainPath+"GetCalendarEvents",GetStudentTermAttendanceDetails:a.mainPath+"GetStudentTermAttendanceDetails",SaveFeedback:a.mainPath+"SaveFeedback",AddFeedback:a.mainPath+"AddFeedback",GetFeedbackTypes:a.mainPath+"GetFeedbackTypes",GetFeedbackCategoriesByType:a.mainPath+"GetFeedbackCategoriesByType",GetFeedbackStepsByTypeCategory:a.mainPath+"GetFeedbackStepsByTypeCategory",GetGalleryList:a.mainPath+"GetUserDMS",GetAllNodes:a.mainPath+"getAllNodes",AddUserDMSFolder:a.mainPath+"AddUserDMSFolder",UpdateDMSFileName:a.mainPath+"UpdateDMSFileName",AddUserDMSFile:a.mainPath+"AddUserDMSFile",DeleteNode:a.mainPath+"DeleteNode",GetDMSPermissionList:a.mainPath+"GetDMSPermissionList",UpdateDMSPermissions:a.mainPath+"UpdateDMSPermissions",SiteLinks:a.mainPath+"GetSiteLinks",GetAttendanceSubjects:a.mainPath+"GetAttendanceSubjects",GetAttendanceAcademicYears:a.mainPath+"GetAttendanceAcademicYears",GetAttendanceTerms:a.mainPath+"GetAttendanceTerms",GetAttendanceSection:a.mainPath+"GetAttendanceSection",GetAttendanceStudentsList:a.mainPath+"GetAttendanceStudentsList",SaveStudentsAttendance:a.mainPath+"SaveStudentsAttendance",GetPaymentOrderId:a.mainPath+"GetPaymentOrderId",GetTransactionDues:a.mainPath+"GetTransactionDues",GetTransactionsPaid:a.mainPath+"GetTransactionsPaid",ValidatePaymentCaptured:a.mainPath+"ValidatePaymentCaptured",DeleteCalendarEvent:a.mainPath+"DeleteCalendarEvent",AddCalendarEvents:a.mainPath+"AddCalendarEvents",GetCommunicatorTypes:a.mainPath+"GetCommunicatorTypes",GetFormsByType:a.mainPath+"GetFormsByType",SendCommunicator:a.mainPath+"SendCommunicator",GetStaffAttendanceRoles:a.mainPath+"GetStaffAttendanceRoles",GetStaffAttendance:a.mainPath+"GetStaffAttendance",SaveStaffAttendance:a.mainPath+"SaveStaffAttendance",GetUsersAsync:a.mainPath+"GetUsersAsync",GetDynamicDashboardsList:a.mainPath+"GetDynamicDashboardsList",GetDynamicDashboardAsync:a.mainPath+"GetDynamicDashboardAsync",GetTrips:a.mainPath+"GetTrips",UpdateTripLocation:a.mainPath+"UpdateTripLocation",GetBusLocationByTripId:a.mainPath+"GetBusLocationByTripId",EndTrip:a.mainPath+"EndTrip",GetTripDropDowns:a.mainPath+"GetTripDropDowns",CreateTrip:a.mainPath+"CreateTrip",SaveGpsAttendance:a.mainPath+"SaveGpsAttendance",GetGpsAttendance:a.mainPath+"GetGpsAttendance",LogMobileFirebaseToken:a.mainPath+"LogMobileFirebaseToken"}}}},6886:(A,f,r)=>{r.d(f,{J:()=>o});var u=r(1626),a=r(4438);let o=(()=>{class g{constructor(l){this.http=l}getHeadres(){let l=new u.Lr;return l.append("Content-Type","application/json"),l}addItemToList(l,p){let e=new u.Lr;return e.append("Content-Type","application/json"),this.http.post(l,p,{headers:e})}login(l,p){return this.http.get(l,{params:p})}registerUser(l,p){return(new u.Lr).append("Content-Type","application/x-www-form-urlencoded"),this.http.post(l,p,{headers:this.getHeadres()})}getCirculerList(l){return this.http.get(l)}static{this.\u0275fac=function(p){return new(p||g)(a.KVO(u.Qq))}}static{this.\u0275prov=a.jDH({token:g,factory:g.\u0275fac,providedIn:"root"})}}return g})()},5454:(A,f,r)=>{r.r(f),r.d(f,{StaffAttendanceSearchPageModule:()=>X});var u=r(177),a=r(4341),o=r(3465),g=r(9522),_=r(467),l=r(1626),p=r(1840),e=r(4438),b=r(3656),T=r(2571),y=r(369),I=r(6886),D=r(5493);function j(s,m){if(1&s&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&s){const t=m.$implicit;e.Y8G("value",t.Id),e.R7$(),e.JRh(t.Name)}}function F(s,m){if(1&s&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&s){const t=m.$implicit;e.Y8G("value",t.Id),e.R7$(),e.JRh(t.Name)}}function M(s,m){if(1&s&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&s){const t=m.$implicit;e.Y8G("value",t.Id),e.R7$(),e.JRh(t.Name)}}function L(s,m){if(1&s&&(e.j41(0,"ion-select-option",17),e.EFF(1),e.k0s()),2&s){const t=m.$implicit;e.Y8G("value",t.Id),e.R7$(),e.JRh(t.Name)}}function v(s,m){if(1&s){const t=e.RV6();e.j41(0,"ion-datetime",18),e.mxI("ngModelChange",function(n){e.eBV(t);const c=e.XpG(2);return e.DH7(c.attendanceDate,n)||(c.attendanceDate=n),e.Njj(n)}),e.k0s()}if(2&s){const t=e.XpG(2);e.FS9("disabled",t.sectionSelected&&""==t.sectionSelected),e.Y8G("showDefaultButtons",!0),e.R50("ngModel",t.attendanceDate)}}function N(s,m){if(1&s){const t=e.RV6();e.j41(0,"ion-card",3)(1,"ion-card-header",4)(2,"ion-card-title"),e.EFF(3," Student Attendance Entrance "),e.k0s()(),e.j41(4,"ion-card-content")(5,"ion-list")(6,"ion-item")(7,"ion-label"),e.EFF(8,"Subject"),e.k0s(),e.j41(9,"ion-select",5),e.mxI("ngModelChange",function(n){e.eBV(t);const c=e.XpG();return e.DH7(c.subjectSelected,n)||(c.subjectSelected=n),e.Njj(n)}),e.bIt("ngModelChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubjectChange())}),e.DNE(10,j,2,2,"ion-select-option",6),e.k0s()(),e.j41(11,"ion-item")(12,"ion-label"),e.EFF(13,"Academic Year"),e.k0s(),e.j41(14,"ion-select",7),e.mxI("ngModelChange",function(n){e.eBV(t);const c=e.XpG();return e.DH7(c.yearSelected,n)||(c.yearSelected=n),e.Njj(n)}),e.bIt("ngModelChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onYearChange())}),e.DNE(15,F,2,2,"ion-select-option",6),e.k0s()(),e.j41(16,"ion-item")(17,"ion-label"),e.EFF(18,"Term"),e.k0s(),e.j41(19,"ion-select",8),e.mxI("ngModelChange",function(n){e.eBV(t);const c=e.XpG();return e.DH7(c.tearmSelected,n)||(c.tearmSelected=n),e.Njj(n)}),e.bIt("ngModelChange",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onTermsChange())}),e.DNE(20,M,2,2,"ion-select-option",6),e.k0s()(),e.j41(21,"ion-item")(22,"ion-label"),e.EFF(23,"Section"),e.k0s(),e.j41(24,"ion-select",9),e.mxI("ngModelChange",function(n){e.eBV(t);const c=e.XpG();return e.DH7(c.sectionSelected,n)||(c.sectionSelected=n),e.Njj(n)}),e.DNE(25,L,2,2,"ion-select-option",6),e.k0s()(),e.j41(26,"ion-item")(27,"ion-label",10),e.EFF(28,"Date"),e.k0s(),e.nrm(29,"ion-input",11),e.nI1(30,"date"),e.j41(31,"ion-popover",12),e.DNE(32,v,1,3,"ng-template"),e.k0s()(),e.j41(33,"ion-row",13)(34,"ion-col",14)(35,"ion-button",15),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSearch())}),e.nrm(36,"ion-icon",16),e.EFF(37," Search "),e.k0s()()()()()()}if(2&s){const t=e.XpG();e.R7$(9),e.R50("ngModel",t.subjectSelected),e.R7$(),e.Y8G("ngForOf",t.subjectsList),e.R7$(4),e.FS9("disabled",t.subjectSelected&&""==t.subjectSelected),e.R50("ngModel",t.yearSelected),e.R7$(),e.Y8G("ngForOf",t.yearsList),e.R7$(4),e.FS9("disabled",t.yearSelected&&""==t.yearSelected),e.R50("ngModel",t.tearmSelected),e.R7$(),e.Y8G("ngForOf",t.termsList),e.R7$(4),e.FS9("disabled",t.tearmSelected&&""==t.tearmSelected),e.R50("ngModel",t.sectionSelected),e.R7$(),e.Y8G("ngForOf",t.sectionsList),e.R7$(4),e.FS9("value",e.i5U(30,13,t.attendanceDate,"dd MMM yyyy")),e.R7$(6),e.FS9("disabled",t.sectionSelected&&""==t.sectionSelected)}}function k(s,m){1&s&&(e.j41(0,"ion-text",29)(1,"h4"),e.EFF(2,"No Students Found"),e.k0s()())}function R(s,m){1&s&&(e.j41(0,"ion-text",30)(1,"h4")(2,"em"),e.EFF(3,"Loading Students Details..."),e.k0s()()())}function C(s,m){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-avatar",10),e.nrm(2,"img",32),e.k0s(),e.j41(3,"ion-label")(4,"h2"),e.EFF(5),e.k0s(),e.j41(6,"h3"),e.EFF(7),e.k0s(),e.j41(8,"h3"),e.EFF(9),e.k0s()(),e.j41(10,"ion-toggle",33),e.bIt("ionChange",function(n){const c=e.eBV(t).$implicit,d=e.XpG(3);return e.Njj(d.onToggle(n,c))}),e.k0s()()}if(2&s){const t=m.$implicit;e.R7$(2),e.Y8G("src",t.UserPhoto,e.B4B),e.R7$(3),e.JRh(t.Name),e.R7$(2),e.JRh(t.ID),e.R7$(2),e.JRh(t.LegacyStudentID),e.R7$(),e.FS9("checked",t.PresentFlag)}}function E(s,m){if(1&s&&(e.j41(0,"ion-list"),e.DNE(1,C,11,5,"ion-item",31),e.k0s()),2&s){const t=e.XpG(2);e.R7$(),e.Y8G("ngForOf",t.studentsList)}}function x(s,m){if(1&s){const t=e.RV6();e.j41(0,"div")(1,"ion-row",19)(2,"ion-col",20)(3,"ion-button",21),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.backToSearch())}),e.nrm(4,"ion-icon",22),e.EFF(5," Back To Search "),e.k0s()(),e.j41(6,"ion-col",23)(7,"ion-button",24),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.saveAttendance())}),e.nrm(8,"ion-icon",25),e.EFF(9," Save Attendance "),e.k0s()()(),e.j41(10,"ion-toolbar")(11,"ion-searchbar",26),e.bIt("keyup",function(n){e.eBV(t);const c=e.XpG();return e.Njj(c.onStudentSearchKeyUp(n))}),e.k0s()(),e.DNE(12,k,3,0,"ion-text",27)(13,R,4,0,"ion-text",28)(14,E,2,1,"ion-list",2),e.k0s()}if(2&s){const t=e.XpG();e.R7$(7),e.FS9("disabled",0==t.studentsChanged.length),e.R7$(5),e.Y8G("ngIf",t.studentsList&&0==t.studentsList.length),e.R7$(),e.Y8G("ngIf",t.isAPiCallInProcess),e.R7$(),e.Y8G("ngIf",t.studentsList&&t.studentsList.length>0)}}const B=[{path:"",component:(()=>{class s{constructor(t,i,n,c,d,h,P){this.platform=t,this.commonService=i,this.router=n,this.storage=c,this.apiCall=d,this.datePipe=h,this.loadingController=P,this.heading="Student Attendance",this.isBackRequired=!0,this.attendanceDate=(new Date).toISOString(),this.showStudents=!1,this.studentsChanged=[]}ngOnInit(){this.meetingData=this.commonService.getSelectedMeeting(),this.getSubjects()}onSubjectChange(){this.getYears(this.subjectSelected)}onYearChange(){this.getTerms(this.subjectSelected,this.yearSelected)}onTermsChange(){this.getSections(this.subjectSelected,this.yearSelected,this.tearmSelected)}onSearch(){this.getStudents(this.subjectSelected,this.yearSelected,this.tearmSelected,this.sectionSelected,this.attendanceDate),this.showStudents=!0}backToSearch(){this.showStudents=!1,this.studentsList=null}getSubjects(){this.storage.get("user").then(t=>{const i=JSON.parse(t);let n=new l.Nl;n=n.append("tenantName",i.TenantShortName),this.isAPiCallInProcess=!0,this.apiCall.login(p.h.urls.GetAttendanceSubjects,n).subscribe(c=>{this.isAPiCallInProcess=!1,this.subjectsList=c,this.subjectsList&&this.subjectsList.length>0&&this.meetingData&&null!=this.meetingData.SubjectId&&(this.subjectSelected=this.meetingData.SubjectId,this.onSubjectChange())},c=>{this.isErrorInApiCall=!0,this.isAPiCallInProcess=!1})})}getYears(t){this.storage.get("user").then(i=>{const n=JSON.parse(i);let c=new l.Nl;c=c.append("tenantName",n.TenantShortName),c=c.append("CourseID",t),this.isAPiCallInProcess=!0,this.apiCall.login(p.h.urls.GetAttendanceAcademicYears,c).subscribe(d=>{this.isAPiCallInProcess=!1,this.yearsList=d,this.yearsList&&this.yearsList.length>0&&(this.yearSelected=this.yearsList[0].Id,this.onYearChange())},d=>{this.isErrorInApiCall=!0,this.isAPiCallInProcess=!1})})}getTerms(t,i){this.storage.get("user").then(n=>{const c=JSON.parse(n);let d=new l.Nl;d=d.append("tenantName",c.TenantShortName),d=d.append("CourseID",t),d=d.append("AYear",i),this.isAPiCallInProcess=!0,this.apiCall.login(p.h.urls.GetAttendanceTerms,d).subscribe(h=>{this.isAPiCallInProcess=!1,this.termsList=h,this.termsList&&this.termsList.length>0&&(this.tearmSelected=this.termsList[0].Id,this.onTermsChange())},h=>{this.isErrorInApiCall=!0,this.isAPiCallInProcess=!1})})}getSections(t,i,n){this.storage.get("user").then(c=>{const d=JSON.parse(c);let h=new l.Nl;h=h.append("tenantName",d.TenantShortName),h=h.append("CourseID",t),h=h.append("AYear",i),h=h.append("SemesterID",n),this.isAPiCallInProcess=!0,this.apiCall.login(p.h.urls.GetAttendanceSection,h).subscribe(P=>{this.isAPiCallInProcess=!1,this.sectionsList=P,this.sectionsList&&this.sectionsList.length>0&&(this.sectionSelected=this.sectionsList[0].Id,this.meetingData&&null!=this.meetingData.SubjectId&&this.onSearch())},P=>{this.isErrorInApiCall=!0,this.isAPiCallInProcess=!1})})}getStudents(t,i,n,c,d){this.storage.get("user").then(h=>{const P=JSON.parse(h);let S=new l.Nl;S=S.append("tenantName",P.TenantShortName),S=S.append("SubjectId",t),S=S.append("AYearId",i),S=S.append("TermId",n),S=S.append("SectionId",c),S=S.append("AttendanceDate",this.datePipe.transform(this.attendanceDate,"yyyy/MM/dd")||""),this.isAPiCallInProcess=!0,this.apiCall.login(p.h.urls.GetAttendanceStudentsList,S).subscribe(G=>{this.isAPiCallInProcess=!1,this.studentsList=G,this.studentsListMain=G},G=>{this.isErrorInApiCall=!0,this.isAPiCallInProcess=!1})})}onStudentSearchKeyUp(t){let i=t.target.value;this.studentsList=0==i.length?this.studentsListMain:this.studentsListMain.filter(n=>n.Name.toLocaleLowerCase().includes(i.toLocaleLowerCase())||(n.ID??"").toString().includes(i)||(n.LegacyStudentID??"").toLocaleLowerCase().toString().includes(i))}onToggle(t,i){i.PresentFlag=!i.PresentFlag;var n=this.studentsChanged.filter(c=>c.ID==i.ID);n&&n.length>0?this.studentsChanged.forEach(function(c){c.ID==i.ID&&(c.PresentFlag=i.PresentFlag)}):this.studentsChanged.push(i)}presentLoading(){var t=this;return(0,_.A)(function*(){t.loading=yield t.loadingController.create({message:"Saving Attendance request details.."}),yield t.loading.present()})()}saveAttendance(){this.presentLoading(),this.storage.get("user").then(t=>{const i=JSON.parse(t);let n=new URLSearchParams;n.append("UserId",i.UserId),n.append("tenantName",i.TenantShortName),n.append("SubjectId",this.subjectSelected),n.append("YearId",this.yearSelected),n.append("TermId",this.tearmSelected),n.append("SectionId",this.sectionSelected),n.append("AttendanceDate",this.datePipe.transform(this.attendanceDate,"MM/dd/yyyy")||""),n.append("AttendanceStr",JSON.stringify(this.studentsChanged));let c=n.toString(),d="";d=p.h.urls.SaveStudentsAttendance+"?UserId="+i.UserId+"&tenantName="+i.TenantShortName+"&SubjectId="+this.subjectSelected+"&YearId="+this.yearSelected+"&TermId="+this.tearmSelected+"&SectionId="+this.sectionSelected+"&AttendanceDate="+this.datePipe.transform(this.attendanceDate,"MM/dd/yyyy")+"&AttendanceStr="+JSON.stringify(this.studentsChanged),this.apiCall.addItemToList(d,JSON.stringify(c)).subscribe(h=>{this.commonService.presentToast("Attendance details saved successfully",3e3),this.loading.dismiss(),this.backToSearch()},h=>{this.loading.dismiss(),this.commonService.presentToast("Internal problem, please try again",3e3,"danger")})})}static{this.\u0275fac=function(i){return new(i||s)(e.rXU(b.OD),e.rXU(T.h),e.rXU(g.Ix),e.rXU(y.w),e.rXU(I.J),e.rXU(u.vh),e.rXU(o.Xi))}}static{this.\u0275cmp=e.VBU({type:s,selectors:[["app-staff-attendance-search"]],standalone:!1,features:[e.Jv_([u.vh])],decls:4,vars:4,consts:[[3,"title","isBackRequired"],["color","primary","no-padding","","class","service-head",4,"ngIf"],[4,"ngIf"],["color","primary","no-padding","",1,"service-head"],[2,"border-bottom","1px solid white","margin-bottom","10px"],["placeholder","Select Subject",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Select Year",3,"ngModelChange","ngModel","disabled"],["placeholder","Select Term",3,"ngModelChange","ngModel","disabled"],["placeholder","Select Section",3,"ngModelChange","ngModel","disabled"],["slot","start"],["slot","end","id","attendanceDate",3,"value"],["trigger","attendanceDate"],[1,"ion-text-center",2,"border-top","1px solid #ffffff"],["size","12"],["color","primary",3,"click","disabled"],["slot","start","name","search"],[3,"value"],["presentation","date","min","2025-01-01T00:00:00","max","2035-12-31T23:59:59","cancelText","Cancel","doneText","OK",3,"ngModelChange","showDefaultButtons","ngModel","disabled"],[2,"border-top","1px solid #ffffff"],["size","6"],["color","danger","size","small",3,"click"],["slot","start","name","chevron-back-outline"],["size","4"],["color","primary","size","small",3,"click","disabled"],["slot","start","name","save-outline"],["placeholder","Search By Student Name / Number","showCancelButton","never",3,"keyup"],["color","danger",4,"ngIf"],["color","primary","class","ion-text-center",4,"ngIf"],["color","danger"],["color","primary",1,"ion-text-center"],[4,"ngFor","ngForOf"],[3,"src"],["slot","end",3,"ionChange","checked"]],template:function(i,n){1&i&&(e.nrm(0,"app-header-toolbar",0),e.j41(1,"ion-content"),e.DNE(2,N,38,16,"ion-card",1)(3,x,15,4,"div",2),e.k0s()),2&i&&(e.Y8G("title",n.heading)("isBackRequired",n.isBackRequired),e.R7$(2),e.Y8G("ngIf",!n.showStudents),e.R7$(),e.Y8G("ngIf",n.showStudents))},dependencies:[u.Sq,u.bT,a.BC,a.vS,o.mC,o.Jm,o.b_,o.I9,o.ME,o.tN,o.hU,o.W9,o.A9,o.iq,o.$w,o.uz,o.he,o.nf,o.ln,o.S1,o.Nm,o.Ip,o.IO,o.BY,o.ai,o.CF,o.hB,o.Je,o.Gw,D.M,u.vh],encapsulation:2})}}return s})()}];let Y=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[g.iI.forChild(B),g.iI]})}}return s})();var O=r(5075);let X=(()=>{class s{static{this.\u0275fac=function(i){return new(i||s)}}static{this.\u0275mod=e.$C({type:s})}static{this.\u0275inj=e.G2t({imports:[u.MD,a.YN,o.bv,Y,O.HomePageModule]})}}return s})()}}]);